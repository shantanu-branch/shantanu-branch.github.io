<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title></title>
  <script>
    // load Branch
      (function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent disableTracking getBrowserFingerprintId crossPlatformIds lastAttributedTouchData".split(" "), 0);
    // init Branch
    branch.init('key_live_hkDytPACtipny3N9XmnbZlapBDdj4WIL', function(err, data) {
      console.log(err, data);
    });
    
    var listener = function(event, data) { 
      console.log(event, data); 
      var journey_clone= document.getElementById("branch-banner-iframe")
      var div = document.querySelector(".mydiv");
      div.body.appendChild(journey_clone);
      testAccess();
    }
    console.log("HELLO WORLD");
    branch.getBrowserFingerprintId(function(err, data) { 
      console.log(data); 
    });
    
    
    // Specify an event to listen for
    branch.addListener('didShowJourney', listener);
    
    document.getElementById('branch-banner-iframe').style.display='none'
    headNode = document.getElementById('branch-banner-iframe').contentDocument.head.cloneNode(true)
    bodyNode = document.getElementById('branch-banner-iframe').contentDocument.body.cloneNode(true)
    ifr = document.createElement('iframe')
    appendAt = document.getElementById('banner-hook') 
    appendAt.appendChild(ifr)
    html = ifr.contentWindow.document.getElementsByTagName('html')[0]
    h = ifr.contentWindow.document.head
    b1 = ifr.contentWindow.document.body
    html.replaceChild(headNode,h)
    html.replaceChild(bodyNode,b1)
    
    function testAccess() {
      var remote = canAccessIFrame(document.getElementById("branch-banner-iframe"));
      console.log("Remote iframe canAccess: ");
      console.log(remote);
    }

    function canAccessIFrame(iframe) {
    var html = null;
    try { 
      // deal with older browsers
      var doc = iframe.contentDocument || iframe.contentWindow.document;
      html = doc.body.innerHTML;
    } catch(err){
      // do nothing
    }

    return(html !== null);
}

  </script>
</head>
<body>
  <p>Hello World</p>
    <div class="mydiv"> </div>
</div>  
</body>
</html>
